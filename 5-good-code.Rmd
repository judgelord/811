---
title: "Reproducable scripts"
author: "Devin Judge-Lord"
date: 
# output: 
#   html_document:
#   toc: true
output:
  xaringan::moon_reader:
    lib_dir: libs
    mathjax: "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"
    css: "templates/xaringan-themer.css"
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
source("setup.R")
```



![](https://imgs.xkcd.com/comics/exploits_of_a_mom.png)

---
class: center inverse

## How to break a research project

![](https://media.giphy.com/media/xUA7aLL1iKj62wBYTC/giphy.gif)

---
### 1. `setwd("C:\Users\path\that\only\I\have"`


--

![](https://media.giphy.com/media/146SJ7jy4BFXHy/giphy.gif)

#### I don't have your file paths!

---

## 2. [Factors](https://www.r-bloggers.com/factors-are-not-first-class-citizens-in-r/)

## If you are working with text (and really, just always), begin with:
## `options(stringsAsFactors = F)`
## Let R coerce strings to factors as needed.
Eventually, learn to master factors with [`forcats`](https://forcats.tidyverse.org/) (e.g., if you want to plot things in a specific order.)

---

## 3 
### `library(SomoneoneOnTheInternetWroteThis)`

--

![](https://media.giphy.com/media/l2R05FZf4dVOrgIaQ/giphy.gif)

## I may not have your packages!

---

## Tip: A seperate script to set it all up
## `source("setup.R")`

```
options(stringsAsFactors = F)

## Add any R packages you require. 
## Here are some we will use in 811:
requires <- c("tidyverse", # tidyverse includes dplyr and ggplot2
              "magrittr",
              "here")

## Install any you don't have
to_install <- c(requires %in% rownames(installed.packages()) == FALSE)
install.packages(c(requires[to_install], "NA"), repos = "https://cloud.r-project.org/" )
```


```
## Load all required R packages
library(tidyverse)
library(ggplot2); theme_set(theme_bw()) ## Set global ggplot theme
library(magrittr)
library(here)
```

---
## `source("setup.R")` continued:

```
## Set defaults for R chunks
knitr::opts_chunk$set(echo = TRUE, # echo = TRUE means that your code will show
                      warning=FALSE,
                      message=FALSE,
                      fig.retina = 2,
                      fig.align = "center", 
                      dpi = 100,
                      # fig.path='Figs/', ## where to save figures
                      fig.height = 3,
                      fig.width = 3)
```

---

## `filter()`

Subset to observations (rows!) matching certain conditions

![](https://media.giphy.com/media/rwsDkSEQyTxPW/giphy.gif)


---

## `select()`

Select certian variables (columns!) or variables matching certian conditions

---


## Functions 

To do the same thing more than once, use [functions](https://r4ds.had.co.nz/functions.html#functions).  [Functions make nicer code](https://nicercode.github.io/guides/functions/). 

Apply functions to vectors or lists of data with [`purrr`](https://www.rstudio.com/resources/cheatsheets/#purrr) (instead of writing loops where we have to index everything).

---

## But don't go overboard
Simpler is often stronger.
![](Figs/data_pipeline.png)

---

## Computing

Have long scripts [send you a text or email](https://github.com/jennybc/send-email-with-r) when they are done.

Spread computation across several cores with [`multidplyr`](https://github.com/hadley/multidplyr/blob/master/vignettes/multidplyr.md)

Use a remote, like [SSCC's linstat cluster](https://www.ssc.wisc.edu/sscc/pubs/linstat.htm)


