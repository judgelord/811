---
title: "Tidy text analysis"
author: "Devin Judge-Lord"
 # output:
 #   html_document:
 #   toc: true
output:
  xaringan::moon_reader:
    lib_dir: libs
    mathjax: "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"
    css: "templates/xaringan-themer.css"
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
source(here::here("setup.R"))
```


## 1. Counting
![](https://media.giphy.com/media/3o7TKu5aIDY4tU3SXm/giphy.gif)

--

- text features $\in$\{all* words, some words, phrases, etc.\} 

---

## 1. Counting

- text features $\in$\{all* words, some words, phrases, etc.\} 

## 2. Matching
![](Figs/same.jpg)

--

- Exactly* the same string ("regular expressions", text reuse)

---

## 1. Counting
- text features $\in$\{all* words, some words, phrases, etc.\} 

## 2. Matching
- Exactly* the same string ("regular expressions", text reuse)

## 3. Classifying
![](Figs/different.jpg)

---

## 1. Counting
- text features $\in$\{all* words, some words, phrases, etc.\}

## 2. Matching
- Exactly* the same string ("regular expressions", text reuse)

## 3. Classifying
- Rules vs. probability

---

## Resources 
- [Tidy text class by Andrew Heiss](https://datavizf18.classes.andrewheiss.com/class/11-class/)
- [`tidytext`](https://cran.r-project.org/web/packages/tidytext/tidytext.pdf) package
- [Tidy text analysis](https://www.tidytextmining.com/) including
[topic modeling](https://www.tidytextmining.com/topicmodeling.html) and
[tidy() for Structural Topic Models](https://juliasilge.github.io/tidytext/reference/stm_tidiers.html) from the `stm` package. More [here](https://rdrr.io/cran/tidytext/man/stm_tidiers.html).

## Reading 
- [Introduction to cluster analysis](https://eight2late.wordpress.com/2015/07/22/a-gentle-introduction-to-cluster-analysis-using-r/)
- Tidy Natural Language Processing with [`cleanNLP`](https://scholarship.richmond.edu/cgi/viewcontent.cgi?article=1195&context=mathcs-faculty-publications)
- [Text from audio](https://www.cambridge.org/core/journals/political-analysis/article/testing-the-validity-of-automatic-speech-recognition-for-political-text-analysis/E375085D96331A47E810C01AA6DB0A46)
- Here is an [ok blog post on visualizing qualitative data](https://depictdatastudio.com/how-to-visualize-qualitative-data/)--lmk if you find a better resource. 

---

## Cool applications:
- [Gender tropes in film](https://pudding.cool/2017/08/screen-direction/)
- [Analysis of Trump's tweets confirms he writes only the (angrier) Android half](http://varianceexplained.org/r/trump-tweets/)

---

class: inverse center

# Counting things in fancy ways.

---

## Word frequency

Responses to ANES question "What do you dislike about [Democrats/Republicans]?" (V161101, V161106)
```{r ANES-data}
load(here("data/ANESdislikes.Rdata"))
d <- ANESdislikes
d[1,]
```

Tokenize by word
```{r ANES-tokens}
words <-  unnest_tokens(d, word, response)
head(words)
```

```{r count, cache = FALSE}
words %<>%
  anti_join(stop_words) %>% ## Replace meaningless words 
  filter(!str_detect("people|just|dont|like|about|democrat.|republican.|party|[0-9]", word) ) %>%
  group_by(question) %>%
  count(word) # Count the number of times each word occurs in each group
```

---

```{r ANESfrequency, fig.height=4, fig.width=6}
top_n(words, 10) %>% ## Top 10 words in each group
  ggplot( aes(x = reorder(word, n), y = n) ) +
  geom_col() + 
  coord_flip() +
  facet_wrap("question", scales = "free_y", strip.position="top") + 
  labs(x = "Word", y = "Count")
```

---

```{r ANES-wordcloud, eval=FALSE}
words %>%
  filter(question == "dislike_about_GOP") %>% 
  with(wordcloud(word, n, max.words = 50))
```

![GOP](Figs/ANES-wordcloud-2.png)

---

Word clouds only show word frequency, and font size is hard to visually compare. Nevertheless, [they may be useful](https://www.vis4.net/blog/2015/01/when-its-ok-to-use-word-clouds/) if all you care about is frequency.

---

class: center inverse

![](https://media.giphy.com/media/14kkd3gt5FJt3a/giphy.gif)
